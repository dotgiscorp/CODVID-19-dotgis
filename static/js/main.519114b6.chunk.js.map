{"version":3,"sources":["store/store.js","layers/Sources/index.js","layers/Classes/MapboxHoverEffect.js","layers/Hooks/useMapEvents.js","components/Loader/index.js","components/PopupTemplate/index.js","components/WidgetsContainer/index.jsx","components/LayerSelector/index.js","components/Geocoder/index.jsx","layers/Config/config.js","layers/Layers/index.js","layers/Classes/CartoMVTRequest.js","layers/Config/queries.js","layers/Config/paints.js","layers/Hooks/useCartoTiles.js","map/index.js","index.js"],"names":["initialState","selectedLayer","store","createContext","Provider","Sources","config","sourceLoad","React","useState","sourcesLoaded","setLoaded","useEffect","newObj","Object","values","info","id","keys","every","k","map","isSource","key","sourceId","tileJsonSource","type","tiles","pbf","promoteId","undefined","onSourceLoaded","layer","HoverEffect","definition","this","sourceLayer","popupFieldsConfig","_hoveredFeature","_hoveredId","_popupInfo","e","getCanvas","style","cursor","features","length","setFeatureState","source","hover","coords","lngLat","popupFields","featureProperties","properties","popupField","hasOwnProperty","lng","lat","shouldRender","value","useMapEvents","layersIds","popupConfig","setPopupConfig","clickedFeature","setClickedFeature","mapObject","hoverObjects","i","push","on","mouseMove","popup","popupInfo","mouseLeave","enableEvents","off","removeEvents","propTypes","PropTypes","instanceOf","Map","isRequired","shape","cadastre_id","object","Loader","dataLoading","setDataLoading","tilesRenderedChecker","once","waiting","isStyleLoaded","setTimeout","className","viewBox","cx","cy","r","fill","defaultProps","component","memo","content","infos","setInfos","index","fieldLabel","Intl","NumberFormat","format","label","prevProps","nextProps","positions","top","right","bottom","left","POSITIONS","WidgetsContainer","children","position","Array","isArray","child","LayerSelector","layers","globalState","useContext","state","dispatch","shouldShowOnInit","payload","switchVisibility","target","name","getLayer","getLayoutProperty","setLayoutProperty","checked","onChange","htmlFor","layerTitle","Geocoder","geocoderContainerRef","useRef","geocoderObject","MapboxGeocoder","accessToken","mapboxgl","marker","color","placeholder","current","appendChild","onAdd","ref","Layers","CONFIG","centerIn","geometry","coordinates","flyTo","center","zoom","Math","round","getZoom","essential","paint","layout","minZoom","maxZoom","display","offset","CartoMVTRequest","cartoAccount","cartoMapsKey","sql","getGeoJSON","aggregationConfig","mapConfig","buffersize","mvt","options","aggregation","fetch","method","headers","body","JSON","stringify","response","json","layergroup","metadata","tilejson","vector","carto_account","carto_maps_key","request_id","sql_query","aggregation_config","query","voronoi","cluster","aggregatedField","pharmacy","supermarket","label_paint","labelField","textColor","useCartoTiles","layersConfig","setLayers","getTiles","a","voronoiInfo","QUERY","pharmacyClusterInfo","threshold","placement","columns","aggregate_function","aggregated_column","filters","greater_than","resolution","pharmacyInfo","supermarketInfo","supermarketClusterInfo","supermarketsVoronoiInfo","Promise","all","then","pharmacy_voronoi_source","pharmacy_voronoi_layer","PAINT","pharmacy_raw_source","pharmacy_raw_layer","nombre","direccion","pharmacy_cluster_source","pharmacy_cluster_layer","pharmacy_cluster_labels_layer","supermarkets_voronoi_source","supermarkets_voronoi_layer","supermarkets_raw_source","supermarkets_raw_layer","supermarkets_cluster_source","supermarkets_cluster_layer","supermarket_cluster_labels_layer","mapFilters","oneOfType","ReactMapboxGL","layersVisibilityConfig","layerColor","MapboxMap","allLoaded","setAllLoaded","setMap","supported","alert","isMobile","fitBounds","containerStyle","width","height","Consumer","app","useReducer","action","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.519114b6.chunk.js","sourcesContent":["import React, { createContext, useReducer } from 'react';\nimport PropTypes from 'prop-types';\n\nconst initialState = {\n  selectedLayer: ''\n};\n\nconst store = createContext(initialState);\nconst { Provider } = store;\n\nconst StateProvider = ({ children }) => {\n  const [state, dispatch] = useReducer((state, action) => {\n    switch (action.type) {\n      case 'switch layer':\n        return { ...state, selectedLayer: action.payload };\n      default:\n        return state;\n    }\n  }, initialState);\n\n  return <Provider value={{ state, dispatch }}>{children}</Provider>;\n};\n\nStateProvider.propTypes = {\n  children: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.node), PropTypes.node]).isRequired\n};\n\nexport { store, StateProvider };\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Source } from 'react-mapbox-gl';\n\nconst Sources = ({ config, sourceLoad }) => {\n  const [sourcesLoaded, setLoaded] = React.useState({});\n\n  React.useEffect(() => {\n    if (config) {\n      const values = Object.values(config);\n\n      let newObj = {};\n      for (const info of values) {\n        newObj = { ...newObj, [info.id]: false };\n      }\n\n      setLoaded(newObj);\n    }\n  }, [config]);\n\n  React.useEffect(() => {\n    if (sourcesLoaded) {\n      const all = Object.keys(sourcesLoaded).every(k => sourcesLoaded[k] === true);\n      all && sourceLoad(true);\n    }\n  }, [sourcesLoaded]);\n\n  const manageLayersLoaded = layer => {\n    setLoaded({ ...sourcesLoaded, [layer]: true });\n  };\n\n  return (\n    <>\n      {Object.values(config).map(\n        info =>\n          info.isSource && (\n            <Source\n              key={info.sourceId}\n              id={info.sourceId}\n              tileJsonSource={{\n                type: 'vector',\n                tiles: info.pbf,\n                promoteId: info.promoteId || undefined\n              }}\n              onSourceLoaded={() => manageLayersLoaded(info.id)}\n            />\n          )\n      )}\n    </>\n  );\n};\n\nSources.propTypes = {\n  config: PropTypes.oneOfType([PropTypes.object]).isRequired,\n  sourceLoad: PropTypes.func.isRequired\n};\n\nexport { Sources };\n","const CURSOR = 'pointer';\n\nclass HoverEffect {\n  constructor(definition) {\n    this.map = definition.map;\n    this.id = definition.id;\n    this.sourceId = definition.sourceId;\n    this.sourceLayer = definition.sourceLayer;\n    this.popupFieldsConfig = definition.popupFieldsConfig || {};\n    this._hoveredFeature = 0;\n    this._hoveredId = null;\n    this._popupInfo = {};\n  }\n\n  get popupInfo() {\n    return this._popupInfo;\n  }\n\n  mouseMove(e) {\n    this.map.getCanvas().style.cursor = CURSOR;\n\n    if (e.features.length > 0) {\n      if (this._hoveredId) {\n        this.map.setFeatureState(\n          {\n            source: this.sourceId,\n            id: this._hoveredId,\n            sourceLayer: this.sourceLayer\n          },\n          { hover: false }\n        );\n      }\n\n      this._hoveredId = e.features[0].id;\n\n      this.map.setFeatureState(\n        {\n          source: this.sourceId,\n          id: this._hoveredId,\n          sourceLayer: this.sourceLayer\n        },\n        { hover: true }\n      );\n    }\n\n    const coords = e.lngLat;\n\n    const popupFields = Object.keys(this.popupFieldsConfig);\n    const featureProperties = e.features[0].properties;\n\n    for (const popupField of popupFields) {\n      if (featureProperties.hasOwnProperty(popupField)) {\n        this._popupInfo = {\n          ...this._popupInfo,\n          coords: [coords.lng, coords.lat],\n          shouldRender: true,\n          info: {\n            ...this._popupInfo.info,\n            [popupField]: {\n              ...this.popupFieldsConfig[popupField],\n              value: featureProperties[popupField]\n            }\n          }\n        };\n      }\n    }\n  }\n\n  mouseLeave() {\n    this.map.getCanvas().style.cursor = '';\n\n    this._popupInfo = { shouldRender: false };\n\n    if (this._hoveredId) {\n      this.map.setFeatureState(\n        {\n          source: this.sourceId,\n          id: this._hoveredId,\n          sourceLayer: this.sourceLayer\n        },\n        { hover: false }\n      );\n    }\n\n    this._hoveredId = null;\n  }\n}\n\nexport default HoverEffect;\n","import React, { useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { Map } from 'mapbox-gl';\nimport HoverEffect from '../Classes/MapboxHoverEffect';\n\nfunction useMapEvents(map, layersIds) {\n  const [popupConfig, setPopupConfig] = useState({\n    shouldRender: false\n  });\n\n  const [clickedFeature, setClickedFeature] = useState(null);\n\n  function enableEvents() {\n    const mapObject = map;\n\n    const hoverObjects = [];\n    const values = Object.values(layersIds);\n\n    for (let i = 0; i < values.length; i += 1) {\n      hoverObjects.push(\n        new HoverEffect({\n          map: mapObject,\n          id: values[i].id,\n          sourceId: values[i].sourceId,\n          sourceLayer: values[i].sourceLayer,\n          popupFieldsConfig: values[i].popupFieldsConfig\n        })\n      );\n    }\n\n    for (let i = 0; i < values.length; i += 1) {\n      mapObject.on('mousemove', values[i].id, e => {\n        hoverObjects[i].mouseMove(e);\n\n        const popup = hoverObjects[i].popupInfo;\n        popup && setPopupConfig(popup);\n      });\n\n      mapObject.on('mouseleave', values[i].id, () => {\n        hoverObjects[i].mouseLeave();\n\n        const popup = hoverObjects[i].popupInfo;\n        popup && setPopupConfig(popup);\n      });\n\n      mapObject.on('click', values[i].id, e => {\n        e.features.length !== 0 && setClickedFeature(e.features[0]);\n      });\n\n      mapObject.on('touchstart', values[i].id, e => {\n        e.features.length !== 0 && setClickedFeature(e.features[0]);\n      });\n    }\n  }\n\n  function removeEvents() {\n    const mapObject = map;\n    const launchedIds = Object.values(layersIds);\n\n    for (const id of launchedIds) {\n      mapObject.off('mousemove', id);\n      mapObject.off('mouseleave', id);\n    }\n  }\n\n  React.useEffect(() => {\n    if (map && layersIds) {\n      enableEvents();\n    }\n\n    return () => {\n      removeEvents();\n    };\n  }, [map, layersIds]);\n\n  return [popupConfig, clickedFeature];\n}\n\nuseMapEvents.propTypes = {\n  map: PropTypes.instanceOf(Map).isRequired,\n  layersIds: PropTypes.shape({\n    cadastre_id: PropTypes.object\n  }).isRequired\n};\n\nexport { useMapEvents };\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Map } from 'mapbox-gl';\nimport './style.scss';\n\nconst Loader = ({ mapObject }) => {\n\n    const [dataLoading, setDataLoading] = React.useState(true);\n\n    React.useEffect(() => {\n        let tilesRenderedChecker = false;\n\n        if (mapObject) {\n            mapObject.once('styledata', () => { // Catch the 'final rendering'\n                const waiting = () => {\n                    if (!mapObject.isStyleLoaded()) {\n                        setTimeout(waiting, 200);\n                    } else {\n                        if (!tilesRenderedChecker) {\n                            setDataLoading(false);\n                        }\n                        tilesRenderedChecker = true;\n                    }\n                };\n                waiting();\n            });\n        }\n    }, [mapObject]);\n\n    return (\n        <div className={`${dataLoading ? 'loader' : 'loader--close'}`}>\n            <div className=\"CDB-LoaderIcon CDB-LoaderIcon--big\">\n                <svg className=\"CDB-LoaderIcon-spinner\" viewBox=\"0 0 50 50\">\n                    <circle className=\"CDB-LoaderIcon-path\" cx=\"25\" cy=\"25\" r=\"20\" fill=\"none\"></circle>\n                </svg>\n            </div>\n        </div>\n    );\n};\n\nLoader.defaultProps = {\n    mapObject: Map\n};\n\nLoader.propTypes = {\n    mapObject: PropTypes.instanceOf(Map)\n};\n\nexport { Loader };\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport './style.scss';\n\nconst PopupTemplate = ({ content }) => {\n  const [infos, setInfos] = React.useState([]);\n\n  React.useEffect(() => {\n    if (content) {\n      setInfos(Object.values(content));\n    }\n  }, [content]);\n\n  const formatInfo = value =>\n    typeof value === 'number' ? `${new Intl.NumberFormat('es').format(value)}` : value;\n\n  return (\n    <div className=\"popup-template\">\n      {infos &&\n        infos.map((info, index) => (\n          <Fragment key={`dynamic-${index}`}>\n            <span className={`popup-template--static popup-template--static-${index + 1}`}>\n              {info.fieldLabel}\n            </span>\n            <div className={`popup-template--dynamic popup-template--dynamic-${index + 1}`}>\n              <span>{formatInfo(info.value)}</span>\n              <span>{info.label}</span>\n            </div>\n          </Fragment>\n        ))}\n    </div>\n  );\n};\n\nPopupTemplate.propTypes = {\n  content: PropTypes.oneOfType([PropTypes.object]).isRequired\n};\n\nfunction arePropsEqual(prevProps, nextProps) {\n  return prevProps.content === nextProps.content;\n};\n\nconst component = React.memo(PopupTemplate, arePropsEqual);\n\nexport { component as PopupTemplate };\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport './style.scss';\n\nconst positions = {\n    'top-right': { top: '1rem', right: '1rem', bottom: 'auto', left: 'auto' },\n    'top-left': { top: '1rem', left: '1rem', bottom: 'auto', right: 'auto' },\n    'bottom-right': { bottom: '1rem', right: '1rem', top: 'auto', left: 'auto' },\n    'bottom-left': { bottom: '1rem', left: '1rem', top: 'auto', right: 'auto' }\n};\n\nconst POSITIONS = Object.keys(positions);\n\nconst WidgetsContainer = ({ children, position }) => (\n    <div className=\"map-container\" style={{ ...positions[position] }}>\n        {Array.isArray(children) ? children : [children].map((child, i) => (\n            <div key={`widget-${i + 1}`} className=\"map-container__child\">\n                {child}\n            </div>\n        ))}\n    </div>\n);\n\nWidgetsContainer.propTypes = {\n    position: PropTypes.oneOf(POSITIONS),\n    // eslint-disable-next-line\n    children: PropTypes.any.isRequired\n};\n\nWidgetsContainer.defaultProps = {\n    position: POSITIONS[0]\n};\n\nexport { WidgetsContainer };\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { store } from '../../store/store';\nimport '@carto/airship-style';\nimport './style.scss';\n\nconst LayerSelector = ({ mapObject, layers }) => {\n    const globalState = React.useContext(store);\n    const { state, dispatch } = globalState;\n\n    React.useEffect(() => {\n        if (layers) {\n            for (const layer of layers) {\n                if (layer.shouldShowOnInit) {\n                    dispatch({ type: 'switch layer', payload: layer.layersIds[0] });\n                }\n            }\n        }\n    }, []);\n\n    const switchVisibility = e => {\n        const id = e.target.name;\n\n        dispatch({ type: 'switch layer', payload: id });\n\n        for (const config of layers) {\n            for (const layer of config.layersIds) {\n                if (mapObject.getLayer(layer)) {\n                    mapObject.getLayoutProperty(layer, 'visibility') === 'visible' ?\n                        mapObject.setLayoutProperty(layer, 'visibility', 'none') :\n                        mapObject.setLayoutProperty(layer, 'visibility', 'visible');\n                }\n            }\n        }\n    };\n\n    return (\n          <div className=\"layers-picker\">\n            {state.selectedLayer && layers.map((layer, index) => (\n                <div key={layer.layersIds[0]} className=\"as-radio\">\n                    <input\n                        className=\"as-radio__input\"\n                        type=\"radio\"\n                        name={layer.layersIds[0]}\n                        id={layer.layersIds[0]}\n                        value={index}\n                        checked={state.selectedLayer === layer.layersIds[0]}\n                        onChange={switchVisibility}\n                    />\n                    <label className=\"as-caption\" htmlFor={layer.layersIds[0]}>{layer.layerTitle}</label>\n                </div>\n            ))}\n          </div>\n    );\n};\n  \nLayerSelector.propTypes = {\n    mapObject: PropTypes.instanceOf(Map).isRequired,\n    layers: PropTypes.arrayOf(\n        PropTypes.shape({\n          shouldShowOnInit: PropTypes.bool,\n          layersIds: PropTypes.arrayOf(PropTypes.string),\n          layerTitle: PropTypes.string,\n          layerColor: PropTypes.string\n        })\n      ).isRequired\n};\n\nexport { LayerSelector };\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport mapboxgl, { Map } from 'mapbox-gl';\nimport MapboxGeocoder from '@mapbox/mapbox-gl-geocoder';\nimport '@mapbox/mapbox-gl-geocoder/dist/mapbox-gl-geocoder.css';\n\nconst Geocoder = ({ mapObject }) => {\n    const geocoderContainerRef = React.useRef(null);\n\n    React.useEffect(() => {\n        const geocoderObject = new MapboxGeocoder({\n            accessToken: 'pk.eyJ1IjoiZG90Z2lzIiwiYSI6ImNrN3o0bmt4NzAyNXEzam9naXVqbm5vb2wifQ.irrtd8SmU9Ce_iQRUAqxEQ',\n            mapboxgl: mapboxgl,\n            marker: { color: '#03fcad' },\n            placeholder: 'Buscar dirección'\n        });\n\n        geocoderContainerRef.current.appendChild(geocoderObject.onAdd(mapObject));\n    }, [geocoderContainerRef]);\n\n    return <div ref={geocoderContainerRef} className=\"calculator-geocoder\"></div>;\n};\n\nGeocoder.propTypes = {\n    mapObject: PropTypes.instanceOf(Map).isRequired\n};\n\nexport { Geocoder };\n","export default {\n    dotgisUser: 'dotgis',\n    dotgisMapsKey: 'wqTxcWJUw09P4IzpBo4kfg',\n  \n    voronoiId: 'voronoi',\n    voronoiSourceId: 'voronoi_source',\n    voronoiSourceLayer: 'voronoi_source_layer',\n\n    pharmacyId: 'pharmacy',\n    pharmacySourceId: 'pharmacy_source_id',\n    pharmacySourceLayer: 'pharmacy_source_layer',\n    aggregatedField: 'pharmacy_aggregated',\n\n    supermarketsVoronoiId: 'supermarkets_voronoi',\n    supermarketsVoronoiSourceId: 'supermarkets_voronoi_source_id',\n    supermarketsVoronoiSourceLayer: 'supermarkets_voronoi_source_layer',\n\n    supermarketsId: 'supermarkets',\n    supermarketsSourceId: 'supermarkets_source_id',\n    supermarketsSourceLayer: 'supermarkets_source_layer',\n    aggregatedSupermarketsField: 'supermarkets_aggregated',\n\n    citiesBounds: {\n      bcn: [\n        [1.8428559879610305, 41.28923112254472],\n        [2.446940749712155, 41.51196575373871]\n      ],\n      madrid: [\n        [-4.2129351236574735, 40.23670360815473],\n        [-3.1320186657642637, 40.64109281781327]\n      ]\n    },\n\n    animatedLayer: {\n      maxRadius: 6,\n      framesPerSecond: 120,\n      initialOpacity: 1,\n      initialRadius: 2\n    }\n  };\n  ","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { store } from '../../store/store';\nimport { Map } from 'mapbox-gl';\nimport { Layer, Popup } from 'react-mapbox-gl';\nimport { useMapEvents } from '../Hooks/useMapEvents';\nimport { PopupTemplate } from '../../components';\nimport CONFIG from '../Config/config';\n\nconst Layers = ({ map, config }) => {\n  const globalState = React.useContext(store);\n\n  const [popupConfig, clickedFeature] = useMapEvents(map, config);\n\n  React.useEffect(() => {\n    if (clickedFeature && (clickedFeature.source === CONFIG.pharmacySourceId || clickedFeature.source === CONFIG.supermarketsSourceId)) {\n      const centerIn = clickedFeature.geometry.coordinates;\n\n      map.flyTo({\n        center: centerIn,\n        zoom: Math.round(map.getZoom() + 2),\n        essential: true\n      });\n    }\n  }, [clickedFeature]);\n\n  return (\n    <>\n      {Object.values(config).map(info => (\n        !info.isSource && <Layer\n          key={info.id}\n          id={info.id}\n          type={info.type}\n          sourceId={info.sourceId}\n          sourceLayer={info.sourceLayer}\n          paint={info.paint}\n          {...(info.layout && { layout: info.layout })}\n          {...(info.minZoom && { minZoom: info.minZoom })}\n          {...(info.maxZoom && { maxZoom: info.maxZoom })}\n        />\n      ))}\n      {popupConfig && popupConfig.coords && (\n        <Popup\n          coordinates={popupConfig.coords}\n          style={{ display: popupConfig.shouldRender ? '' : 'none' }}\n          offset={{\n            bottom: [0, 80]\n          }}\n        >\n          <PopupTemplate content={popupConfig.info} />\n        </Popup>\n      )}\n    </>\n  );\n};\n\nLayers.propTypes = {\n  map: PropTypes.instanceOf(Map).isRequired,\n  config: PropTypes.oneOfType([PropTypes.object]).isRequired\n};\n\nexport { Layers };\n","class CartoMVTRequest {\n    constructor(definition) {\n      this.cartoAccount = definition.cartoAccount;\n      this.cartoMapsKey = definition.cartoMapsKey;\n      this.id = definition.id;\n      this.sql = definition.sql;\n      this.getGeoJSON = definition.getGeoJSON;\n      this.aggregationConfig = definition.aggregationConfig;\n    }\n  \n    async getTiles() {\n      const mapConfig = {\n        buffersize: { mvt: 1 },\n        layers: [\n          {\n            id: this.id,\n            type: 'mapnik',\n            options: {\n              sql: this.sql,\n              aggregation: this.aggregationConfig || undefined,\n              id: 'cartodb_id'\n            }\n          }\n        ]\n      };\n  \n      const response = await fetch(\n        `https://${this.cartoAccount}.carto.com/api/v1/map${\n          this.cartoMapsKey ? `?api_key=${this.cartoMapsKey}` : ''\n        }`,\n        {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify(mapConfig)\n        }\n      );\n  \n      const layergroup = await response.json();\n  \n      return layergroup.metadata.tilejson.vector.tiles;\n    }\n  \n    get requestInfo() {\n      return {\n        carto_account: this.cartoAccount,\n        carto_maps_key: this.cartoMapsKey,\n        request_id: this.id,\n        sql_query: this.sql,\n        aggregation_config: this.aggregationConfig || undefined\n      };\n    }\n  \n    set updateSql(query) {\n      this.sql = query;\n    }\n  }\n  \n  export default CartoMVTRequest;\n  ","export default {\n    voronoi: 'SELECT * FROM voronoi_farmacias',\n    pharmacy: 'SELECT * FROM farmacias',\n    supermarketVoronoi: 'SELECT * FROM voronoi_supermkt_madrid',\n    supermarket: 'SELECT * FROM supermercados_madrid'\n};\n","export default {\n    voronoi: {\n        'fill-color': ['case', ['boolean', ['feature-state', 'hover'], false], 'rgba(204, 102, 255, 0.15)', 'rgba(204, 102, 255, 0.1)'],\n        'fill-outline-color': 'rgba(204, 102, 255, 0.3)',\n    },\n    cluster: aggregatedField => ({\n        'circle-color': ['step', ['get', aggregatedField], 'rgba(0, 0, 0, 0)', 100, '#b4d9cc', 750, '#63a6a0', 2000, '#287274'],\n        'circle-radius': [\n            'case',\n            ['>', ['get', aggregatedField], 1],\n            ['step', ['get', aggregatedField], 20, 100, 30, 750, 40],\n            6\n        ],\n    }),\n    pharmacy: {\n        'circle-color': ['case', ['boolean', ['feature-state', 'hover'], false], 'rgb(255, 102, 0)', 'rgb(0, 255, 0)'],\n        'circle-radius': ['interpolate', ['exponential', 0.7], ['zoom'], 4, 0, 10, 3, 15, 5, 20, 7]\n    },\n    supermarket: {\n        'circle-color': ['case', ['boolean', ['feature-state', 'hover'], false], 'rgb(255, 102, 0)', 'rgb(0, 102, 255)'],\n        'circle-radius': ['interpolate', ['exponential', 0.7], ['zoom'], 4, 0, 10, 3, 15, 5, 20, 7]\n    },\n    label_paint: labelField => ({\n        textColor: {\n            'text-color': ['case', ['>', ['get', labelField], 100], '#333', 'rgba(0, 0, 0, 0)']\n        },\n        layout: {\n            'text-field': `{${labelField}}`,\n            'text-font': ['DIN Offc Pro Medium', 'Arial Unicode MS Bold'],\n            'text-size': ['step', ['get', labelField], 12, 100, 13, 750, 14],\n            'text-allow-overlap': true\n        }\n    })\n};\n","import React, { useState } from 'react';\nimport PropTypes from 'prop-types';\nimport CartoMVTRequest from '../Classes/CartoMVTRequest';\nimport QUERY from '../Config/queries';\nimport CONFIG from '../Config/config';\nimport PAINT from '../Config/paints';\n\nfunction useCartoTiles() {\n  const [layersConfig, setLayers] = useState(null);\n\n  const getTiles = async () => {\n      \n    const voronoiInfo = new CartoMVTRequest({\n      cartoAccount: CONFIG.dotgisUser,\n      cartoMapsKey: CONFIG.dotgisMapsKey,\n      id: CONFIG.voronoiSourceLayer,\n      sql: QUERY.voronoi\n    });\n\n    const pharmacyClusterInfo = new CartoMVTRequest({\n      cartoAccount: CONFIG.dotgisUser,\n      cartoMapsKey: CONFIG.dotgisMapsKey,\n      id: CONFIG.pharmacySourceLayer,\n      sql: QUERY.pharmacy,\n      aggregationConfig: {\n        threshold: 1,\n        placement: 'centroid',\n        columns: {\n          [CONFIG.aggregatedField]: {\n            aggregate_function: 'count',\n            aggregated_column: 'rid'\n          }\n        },\n        filters: {\n          [CONFIG.aggregatedField]: { greater_than: 1 }\n        },\n        resolution: 64\n      }\n    });\n\n    const pharmacyInfo = new CartoMVTRequest({\n      cartoAccount: CONFIG.dotgisUser,\n      cartoMapsKey: CONFIG.dotgisMapsKey,\n      id: `${CONFIG.pharmacySourceLayer}_raw`,\n      sql: QUERY.pharmacy\n    });\n\n    const supermarketInfo = new CartoMVTRequest({\n      cartoAccount: CONFIG.dotgisUser,\n      cartoMapsKey: CONFIG.dotgisMapsKey,\n      id: `${CONFIG.supermarketsSourceLayer}_raw`,\n      sql: QUERY.supermarket\n    });\n\n    const supermarketClusterInfo = new CartoMVTRequest({\n      cartoAccount: CONFIG.dotgisUser,\n      cartoMapsKey: CONFIG.dotgisMapsKey,\n      id: CONFIG.supermarketsSourceLayer,\n      sql: QUERY.supermarket,\n      aggregationConfig: {\n        threshold: 1,\n        placement: 'centroid',\n        columns: {\n          [CONFIG.aggregatedSupermarketsField]: {\n            aggregate_function: 'count',\n            aggregated_column: 'id_super'\n          }\n        },\n        filters: {\n          [CONFIG.aggregatedSupermarketsField]: { greater_than: 1 }\n        },\n        resolution: 64\n      }\n    });\n\n    const supermarketsVoronoiInfo = new CartoMVTRequest({\n      cartoAccount: CONFIG.dotgisUser,\n      cartoMapsKey: CONFIG.dotgisMapsKey,\n      id: CONFIG.supermarketsVoronoiSourceLayer,\n      sql: QUERY.supermarketVoronoi\n    });\n\n    Promise.all([\n      voronoiInfo.getTiles(),\n      pharmacyClusterInfo.getTiles(),\n      pharmacyInfo.getTiles(),\n      supermarketInfo.getTiles(),\n      supermarketClusterInfo.getTiles(),\n      supermarketsVoronoiInfo.getTiles()\n    ]).then(response => {\n      setLayers({\n        pharmacy_voronoi_source: {\n          isSource: true,\n          sourceId: CONFIG.voronoiSourceId,\n          pbf: response[0],\n          promoteId: 'cartodb_id'\n        },\n        pharmacy_voronoi_layer: {\n          id: CONFIG.voronoiId,\n          sourceId: CONFIG.voronoiSourceId,\n          sourceLayer: CONFIG.voronoiSourceLayer,\n          type: 'fill',\n          paint: PAINT.voronoi,\n          layout: {\n            'visibility': 'visible'\n          }\n        },\n        pharmacy_raw_source: {\n          isSource: true,\n          sourceId: `${CONFIG.pharmacySourceId}_raw`,\n          pbf: response[2],\n          promoteId: 'cartodb_id'\n        },\n        pharmacy_raw_layer: {\n          id: `${CONFIG.pharmacyId}_raw`,\n          sourceId: `${CONFIG.pharmacySourceId}_raw`,\n          sourceLayer: `${CONFIG.pharmacySourceLayer}_raw`,\n          type: 'circle',\n          paint: PAINT.pharmacy,\n          popupFieldsConfig: {\n            nombre: {\n              fieldLabel: 'Nombre',\n              label: ''\n            },\n            direccion: {\n              fieldLabel: 'Dirección',\n              label: ''\n            },\n          },\n          layout: {\n            'visibility': 'visible'\n          }\n        },\n        pharmacy_cluster_source: {\n          isSource: true,\n          sourceId: CONFIG.pharmacySourceId,\n          pbf: response[1],\n          promoteId: 'cartodb_id'\n        },\n        pharmacy_cluster_layer: {\n          id: CONFIG.pharmacyId,\n          sourceId: CONFIG.pharmacySourceId,\n          sourceLayer: CONFIG.pharmacySourceLayer,\n          type: 'circle',\n          paint: PAINT.cluster(CONFIG.aggregatedField),\n          layout: {\n            'visibility': 'visible'\n          }\n        },\n        pharmacy_cluster_labels_layer: {\n          id: `${CONFIG.pharmacyId}_labels`,\n          sourceId: CONFIG.pharmacySourceId,\n          sourceLayer: CONFIG.pharmacySourceLayer,\n          type: 'symbol',\n          paint: PAINT.label_paint(CONFIG.aggregatedField).textColor,\n          layout: { 'visibility': 'visible', ...PAINT.label_paint(CONFIG.aggregatedField).layout }\n        },\n        supermarkets_voronoi_source: {\n          isSource: true,\n          sourceId: CONFIG.supermarketsVoronoiSourceId,\n          pbf: response[5],\n          promoteId: 'cartodb_id'\n        },\n        supermarkets_voronoi_layer: {\n          id: CONFIG.supermarketsVoronoiId,\n          sourceId: CONFIG.supermarketsVoronoiSourceId,\n          sourceLayer: CONFIG.supermarketsVoronoiSourceLayer,\n          type: 'fill',\n          paint: PAINT.voronoi,\n          layout: {\n            'visibility': 'none'\n          }\n        },\n        supermarkets_raw_source: {\n          isSource: true,\n          sourceId: `${CONFIG.supermarketsSourceId}_raw`,\n          pbf: response[3],\n          promoteId: 'cartodb_id'\n        },\n        supermarkets_raw_layer: {\n          id: `${CONFIG.supermarketsId}_raw`,\n          sourceId: `${CONFIG.supermarketsSourceId}_raw`,\n          sourceLayer: `${CONFIG.supermarketsSourceLayer}_raw`,\n          type: 'circle',\n          paint: PAINT.supermarket,\n          popupFieldsConfig: {\n            nombre: {\n              fieldLabel: 'Nombre',\n              label: ''\n            },\n            direccion: {\n              fieldLabel: 'Dirección',\n              label: ''\n            },\n          },\n          layout: {\n            'visibility': 'none'\n          }\n        },\n        supermarkets_cluster_source: {\n          isSource: true,\n          sourceId: CONFIG.supermarketsSourceId,\n          pbf: response[4],\n          promoteId: 'cartodb_id'\n        },\n        supermarkets_cluster_layer: {\n          id: CONFIG.supermarketsId,\n          sourceId: CONFIG.supermarketsSourceId,\n          sourceLayer: CONFIG.supermarketsSourceLayer,\n          type: 'circle',\n          paint: PAINT.cluster(CONFIG.aggregatedSupermarketsField),\n          layout: {\n            'visibility': 'none'\n          }\n        },\n        supermarket_cluster_labels_layer: {\n          id: `${CONFIG.supermarketsId}_labels`,\n          sourceId: CONFIG.supermarketsSourceId,\n          sourceLayer: CONFIG.supermarketsSourceLayer,\n          pbf: response[4],\n          promoteId: 'cartodb_id',\n          type: 'symbol',\n          paint: PAINT.label_paint(CONFIG.aggregatedSupermarketsField).textColor,\n          layout: { 'visibility': 'none', ...PAINT.label_paint(CONFIG.aggregatedSupermarketsField).layout }\n        },\n      });\n    });\n  };\n\n  React.useEffect(() => {\n    getTiles();\n  }, []);\n\n  return [layersConfig];\n}\n\nuseCartoTiles.propTypes = {\n  mapFilters: PropTypes.oneOfType([PropTypes.object]).isRequired\n};\n\nexport { useCartoTiles };\n","import React from 'react';\nimport mapboxgl from 'mapbox-gl';\nimport ReactMapboxGL, { MapContext, ZoomControl } from 'react-mapbox-gl';\nimport { Sources, Layers, useCartoTiles } from '../layers';\nimport { Loader, WidgetsContainer, LayerSelector, Geocoder } from '../components';\nimport CONFIG from '../layers/Config/config';\nimport { isMobile } from 'react-device-detect';\n\nconst Map = ReactMapboxGL({\n  accessToken:\n    'pk.eyJ1IjoiZG90Z2lzIiwiYSI6ImNqd3Z6amtjMTBjOTA0OW84ZjVvYzF6bjQifQ.LIbUaYq3GaiWTzsBV6YnTA'\n});\n\nconst style = 'mapbox://styles/mapbox/dark-v10';\n\nconst checkBrowserSupport = () => {\n  if (!mapboxgl.supported()) {\n    // eslint-disable-next-line\n    alert('Tu navegador no soporta Mapbox GL JS.');\n    return false;\n  }\n  return true;\n};\n\nconst layersVisibilityConfig = [\n  { shouldShowOnInit: true, layersIds: [CONFIG.pharmacyId, CONFIG.voronoiId, `${CONFIG.pharmacyId}_raw`, `${CONFIG.pharmacyId}_labels`], layerTitle: 'Farmacias', layerColor: 'rgb(0, 255, 0)' },\n  { shouldShowOnInit: false, layersIds: [CONFIG.supermarketsId, CONFIG.supermarketsVoronoiId, `${CONFIG.supermarketsId}_raw`, `${CONFIG.supermarketsId}_labels`], layerTitle: 'Supermercados', layerColor: 'rgb(0, 102, 255)' }\n]\n\nconst MapboxMap = () => {\n  const [allLoaded, setAllLoaded] = React.useState(false);\n  const [mapObject, setMap] = React.useState(null);\n  const [layersConfig] = useCartoTiles();\n\n  return (\n    <>\n      {checkBrowserSupport() && (\n        <>\n          {\n            mapObject && (\n              <>\n                <Loader mapObject={mapObject} />\n                <WidgetsContainer position=\"top-left\">\n                  <Geocoder mapObject={mapObject} />\n                </WidgetsContainer>\n                <WidgetsContainer position={isMobile ? 'bottom-right' : 'top-right'}>\n                  <LayerSelector key=\"layer-picker\" mapObject={mapObject} layers={layersVisibilityConfig} />\n                </WidgetsContainer>\n              </>\n            )\n          }\n          <Map\n            style={style}\n            fitBounds={[\n              [-4.2129351236574735, 40.23670360815473],\n              [-3.1320186657642637, 40.64109281781327]\n            ]}\n            containerStyle={{\n              position: 'absolute',\n              width: '100%',\n              height: '100%'\n            }}\n          >\n            <MapContext.Consumer>\n              {map => {\n                setMap(map);\n\n                return (\n                  <>\n                    {layersConfig && (\n                      <>\n                        <Sources\n                          key=\"sources\"\n                          config={layersConfig}\n                          sourceLoad={response => setAllLoaded(response)}\n                        />\n                        {allLoaded && (\n                          <>\n                            <Layers key=\"map\" map={map} config={layersConfig} />\n                          </>\n                        )}\n                        <ZoomControl key=\"zoom-control\" position=\"bottom-left\" />\n                      </>\n                    )}\n                  </>\n                );\n              }}\n            </MapContext.Consumer>\n          </Map>\n        </>\n      )}\n    </>\n  );\n};\n\nexport default MapboxMap;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { StateProvider } from './store/store.js';\nimport App from './map';\nimport './index.css';\n\nconst app = (\n    <StateProvider>\n      <App />\n    </StateProvider>\n);\n\nReactDOM.render(app, document.getElementById('root'));\n"],"sourceRoot":""}